<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cierre de Sucursal</title>
<style>
    /* Ajuste seguro para impresora 58 mm */
    body {
        width: 52mm;            /* ← ANTES 54mm – ahora 52mm para evitar cortes */
        margin: 0 auto;
        padding: 2mm 1mm 2mm 2mm; /* ← 1mm extra a la derecha */
        font-family: Arial, sans-serif;
        font-size: 13px;
        color: #000 !important;
        font-weight: 900;
        background-color: #fff;
    }

    .center { text-align: center; }
    .right { text-align: right; }

    .dashed-line {
        border-top: 2px dashed #000;
        margin: 5px 0;
        width: 100%;
    }

    table {
        width: 100%;
        max-width: 100%;       /* ← asegura que no se pase del ancho */
        border-collapse: collapse;
        font-weight: 900;
        word-break: break-all; /* ← evita desbordes */
    }

    td, th {
        padding: 2px 0;
        vertical-align: top;
    }

    @media print {
        #printBtn { display: none; }
    }

    #printBtn {
        margin-top: 10px;
        width: 100%;
        padding: 10px;
        background: #000;
        color: #fff;
        border: none;
        font-family: Arial, sans-serif;
        font-weight: bold;
        cursor: pointer;
    }
</style>
</head>
<body>

<div class="center" style="font-size: 15px; font-weight: 900;">CIERRE DE SUCURSAL</div>
<div class="center" id="sucursal" style="margin-bottom: 5px; font-weight: 900;"></div>

<div class="dashed-line"></div>

<div>Fecha: <span id="fecha"></span></div>
<div>Usuario: <span id="usuario"></span></div>

<div class="dashed-line"></div>

<div style="margin-bottom: 2px; font-weight: 900;">CONTEOS (CANTIDAD)</div>
<table>
    <tr><td>Parqueo</td><td class="right" id="cnt_parque">0</td></tr>
    <tr><td>Carritos</td><td class="right" id="cnt_carritos">0</td></tr>
    <tr><td>Mensualidad</td><td class="right" id="cnt_mensual">0</td></tr>
    <tr><td>Bodegas</td><td class="right" id="cnt_bodegas">0</td></tr>
    <tr><td>Baños</td><td class="right" id="cnt_banio">0</td></tr>
    <tr><td>Gastos</td><td class="right" id="cnt_gastos">0</td></tr>
</table>

<div class="dashed-line"></div>

<div style="margin-bottom: 2px; font-weight: 900;">TOTALES (DINERO)</div>
<table>
    <tr><td>Parqueo</td><td class="right" id="total_parque">0</td></tr>
    <tr><td>Carritos</td><td class="right" id="total_carritos">0</td></tr>
    <tr><td>Mensualidad</td><td class="right" id="total_mensual">0</td></tr>
    <tr><td>Bodegas</td><td class="right" id="total_bodegas">0</td></tr>
    <tr><td>Baños</td><td class="right" id="total_banio">0</td></tr>
    <tr><td>Gastos</td><td class="right" id="total_gastos">0</td></tr>
</table>

<div class="dashed-line"></div>

<table>
    <tr style="font-size: 14px; font-weight: 900;">
        <td>TOTAL EFECTIVO:</td>
        <td class="right" id="total_efectivo"></td>
    </tr>
    <tr>
        <td>Transacciones:</td>
        <td class="right" id="transacciones"></td>
    </tr>
    <tr style="font-weight: 900; font-size: 14px;">
        <td>CUADRE:</td>
        <td class="right" id="cuadre"></td>
    </tr>
</table>

<div class="dashed-line"></div>

<br><br><br>
<div style="border-top: 2px solid #000; width: 80%; margin: 0 auto;"></div>
<div class="center" style="margin-top: 5px; font-weight: 900;">Firma Responsable</div>
<br>

<div class="center">*** FIN DEL CIERRE ***</div>
<br>

<button id="printBtn" onclick="window.print()">IMPRIMIR</button>

<script>
function getParam(name){
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(name);
}

function formatMoney(amount){
    if (!amount || isNaN(amount)) return "$ 0";
    return new Intl.NumberFormat('es-CO', {
        style: 'currency',
        currency: 'COP',
        minimumFractionDigits: 0
    }).format(amount);
}

document.addEventListener("DOMContentLoaded", function(){

    const textFields = [
        "sucursal","fecha","usuario",
        "cnt_parque","cnt_carritos","cnt_mensual",
        "cnt_bodegas","cnt_banio","cnt_gastos","transacciones"
    ];

    textFields.forEach(id=>{
        const val=getParam(id);
        if(val) document.getElementById(id).textContent=val;
    });

    const moneyFields=[
        "total_parque","total_carritos","total_mensual",
        "total_bodegas","total_banio","total_gastos",
        "total_efectivo","cuadre"
    ];

    moneyFields.forEach(id=>{
        const val=getParam(id);
        document.getElementById(id).textContent = formatMoney(parseFloat(val||0));
    });
});
</script>

</body>
</html>
